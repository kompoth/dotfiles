#!/bin/bash
# Some basic umess notifications for bspwm.
# Author: Vasily Negrebetskiy

FONT="Iosevka:size=12"
FG="#1c1b19"
BG="#baa67f"
MON=$(bspc query -M -d focused --names)
TIME=2

PIDS=$(pgrep umess)
[ ! -z "$PIDS" ] && kill $PIDS

STRING=""
case $1 in
  -t|--time)
    STRING=$(date '+%Y-%m-%d %H:%M')
    ;;
  -d|--desktop)
    STRING=$(bspc query -D -d focused --names)
    ;;
  -b|--battery)
    STRING=$(acpi | perl -ne "/^Battery \d*: ([A-Za-z]{3})[a-z]*, (\d+%), (\d+:\d+):\d+/ && printf \"%s %s | rem %s\", lc \$1, \$2, \$3")
    ;;
  -l|--language)
    STRING=$(setxkbmap -query | perl -ne "/^layout:\s*([A-Za-z]+)$/ && print \$1")
    ;;
  -bl|--backlight)
    STRING=$(brightnessctl | grep -oP "\d+%")
    ;;
  -v|--volume)
    STRING=$(amixer get Master | perl -ne "/(\d+\%).*(\bon\b|\boff\b)/ && print \$2.' '.\$1") 
    ;;
esac

(echo $STRING; sleep $TIME) | umess -b -f $FONT -m $MON -F $FG -B $BG 
